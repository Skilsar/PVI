{"ast":null,"code":"import _regeneratorRuntime from\"D:/BSTU/practica/PWI/Lab16/react/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/BSTU/practica/PWI/Lab16/react/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/BSTU/practica/PWI/Lab16/react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import{WsrefListComponent}from\"./wsref-list.component\";import{RoleNames}from\"../util/role-names\";import axios from\"axios\";import{ApiManager}from\"../util/api.manager\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export function UwsrComponent(){var _useState=useState(RoleNames.GUEST),_useState2=_slicedToArray(_useState,2),role=_useState2[0],setRole=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),admin=_useState6[0],setAdmin=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),guest=_useState8[0],setGuest=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),wsrefList=_useState10[0],setWsrefList=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),inserting=_useState12[0],setInserting=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),filtering=_useState14[0],setFiltering=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),filter=_useState16[0],setFilter=_useState16[1];var authorize=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.post(\"\",{password:password});case 3:setRole(RoleNames.ADMIN);_context.next=13;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);if(!_context.t0.response){_context.next=12;break;}console.error(\"Error \".concat(_context.t0.response.status),_context.t0.response.data);_context.next=13;break;case 12:throw _context.t0;case 13:case\"end\":return _context.stop();}},_callee,null,[[0,6]]);}));return function authorize(){return _ref.apply(this,arguments);};}();var logout=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var wsrefsData;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return ApiManager.get(\"/wsref\",{filter:(filter===null||filter===void 0?void 0:filter.length)>0?filter:undefined});case 3:wsrefsData=_context2.sent;if(wsrefsData)setWsrefList(wsrefsData);sessionStorage.removeItem(\"JSESSIONID\");console.log('id1');_context2.next=16;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);if(!_context2.t0.response){_context2.next=15;break;}console.error(\"Error \".concat(_context2.t0.response.status),_context2.t0.response.data);_context2.next=16;break;case 15:throw _context2.t0;case 16:case\"end\":return _context2.stop();}},_callee2,null,[[0,9]]);}));return function logout(){return _ref2.apply(this,arguments);};}();var handleKeyPress=function handleKeyPress(e){if(e.ctrlKey&&e.altKey){switch(e.code){case\"KeyA\":setAdmin(true);break;case\"KeyG\":setGuest(true);break;}}};useEffect(function(){window.addEventListener(\"keydown\",handleKeyPress);return function(){window.removeEventListener(\"keydown\",handleKeyPress);};},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"-- UWSR --\"}),admin?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex\",children:/*#__PURE__*/_jsx(\"input\",{name:\"password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);}})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(e){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return logout();case 2:_context3.next=4;return authorize();case 4:setAdmin(false);case 5:case\"end\":return _context3.stop();}},_callee3);}));return function(_x){return _ref3.apply(this,arguments);};}(),children:\"Set\"}),/*#__PURE__*/_jsx(\"button\",{onClick:/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(e){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:setRole(RoleNames.GUEST);setAdmin(false);_context4.next=4;return logout();case 4:case\"end\":return _context4.stop();}},_callee4);}));return function(_x2){return _ref4.apply(this,arguments);};}(),children:\"Reset\"})]})]}):null,guest?/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){setRole(RoleNames.GUEST);setGuest(false);},children:\"Reset\"})})}):null,/*#__PURE__*/_jsx(WsrefListComponent,{role:role})]});}","map":{"version":3,"names":["useEffect","useState","WsrefListComponent","RoleNames","axios","ApiManager","jsx","_jsx","jsxs","_jsxs","UwsrComponent","_useState","GUEST","_useState2","_slicedToArray","role","setRole","_useState3","_useState4","password","setPassword","_useState5","_useState6","admin","setAdmin","_useState7","_useState8","guest","setGuest","_useState9","_useState10","wsrefList","setWsrefList","_useState11","_useState12","inserting","setInserting","_useState13","_useState14","filtering","setFiltering","_useState15","_useState16","filter","setFilter","authorize","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","post","ADMIN","t0","response","console","error","concat","status","data","stop","apply","arguments","logout","_ref2","_callee2","wsrefsData","_callee2$","_context2","get","length","undefined","sent","sessionStorage","removeItem","log","handleKeyPress","e","ctrlKey","altKey","code","window","addEventListener","removeEventListener","children","className","name","value","onChange","target","onClick","_ref3","_callee3","_callee3$","_context3","_x","_ref4","_callee4","_callee4$","_context4","_x2"],"sources":["D:/BSTU/practica/PWI/Lab16/react/src/components/uwsr.component.tsx"],"sourcesContent":["import {useEffect, useState} from \"react\";\nimport {WsrefListComponent} from \"./wsref-list.component\";\nimport {RoleNames} from \"../util/role-names\";\nimport axios from \"axios\";\nimport { ApiManager } from \"../util/api.manager\";\n\nexport function UwsrComponent() {\n    let [role, setRole] = useState(RoleNames.GUEST)\n    let [password, setPassword] = useState(\"\");\n    let [admin, setAdmin] = useState(false);\n    let [guest, setGuest] = useState(false);\n      let [wsrefList, setWsrefList] = useState<any[]>();\n      let [inserting, setInserting] = useState(false);\n      let [filtering, setFiltering] = useState(false);\n      let [filter, setFilter] = useState(\"\");\n    const authorize = async () => {\n        try {\n            await axios.post(\"\", {password});\n            setRole(RoleNames.ADMIN);\n        } catch (error: any) {\n            if (error.response)\n                console.error(`Error ${error.response.status}`, error.response.data);\n            else throw error;\n        }\n    }\n    const logout = async () => {\n        try {\n           let wsrefsData = await ApiManager.get(`/wsref`, {\n             filter: filter?.length > 0 ? filter : undefined,\n           });\n           if (wsrefsData) setWsrefList(wsrefsData);\n           sessionStorage.removeItem(\"JSESSIONID\");\n             console.log('id1');\n        } catch (error: any) {\n            if (error.response)\n                console.error(`Error ${error.response.status}`, error.response.data);\n            else throw error;\n        }\n    }\n      \n    const handleKeyPress = (e: KeyboardEvent) => {\n        if (e.ctrlKey && e.altKey) {\n            switch (e.code) {\n                case \"KeyA\":\n                    setAdmin(true);\n                    break;\n                case \"KeyG\":\n                    setGuest(true);\n                    break;\n            }\n        }\n    }\n    useEffect(() => {\n        window.addEventListener(\"keydown\", handleKeyPress);\n        return () => {\n            window.removeEventListener(\"keydown\", handleKeyPress);\n        };\n    }, []);\n    return (\n        <div>\n            <h1>-- UWSR --</h1>\n            {admin ? <div>\n                <div className={\"flex\"}>\n                    <input name={\"password\"} value={password} onChange={(e: any) => setPassword(e.target.value)}/>\n                </div>\n                <div>\n                    <button onClick={async (e: any) => {\n                         await logout();\n                        await authorize();\n                        setAdmin(false);\n                    }}>Set\n                    </button>\n                    <button onClick={async (e: any) => {\n                        setRole(RoleNames.GUEST);\n                        setAdmin(false);\n                        await logout();\n                    }}>Reset\n                    </button>\n                </div>\n            </div> : null}\n            {guest ? <div>\n                <div>\n                    <button onClick={(e: any) => {\n                        setRole(RoleNames.GUEST);\n                        setGuest(false);\n                    }}>Reset\n                    </button>\n                </div>\n            </div> : null}\n            <WsrefListComponent role={role}/>\n        </div>\n    );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}